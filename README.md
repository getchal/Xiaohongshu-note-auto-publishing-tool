# 小红书自动化内容生成与发布工具

这是一个基于AI的小红书自动化内容生成和发布工具，能够自动生成图文内容并发布到小红书平台。

## 🚀 主要功能

### 1. AI内容生成
- 使用DeepSeek API自动生成小红书笔记标题和文案
- 支持自定义内容主题（默认：人文摄影）
- 生成符合小红书风格的爆款标题和文案
- 自动添加相关话题标签

### 2. 图片生成
- 将AI生成的文案转换为HTML代码
- 使用Playwright将HTML渲染为图片
- 支持为每篇笔记生成多张配图（默认3张）
- 自动生成美观的配图

### 3. 自动化发布
- 使用Playwright自动化操作小红书创作平台
- 支持二维码扫码登录
- 自动保存和恢复登录状态
- 按照正确的发布流程：上传图文 → 上传图片 → 编辑内容 → 发布

## 📁 项目结构

```
xhs_ai/
├── xiaohongshu_auto.py          # 主程序文件
├── redbook_auth_state.json      # 登录认证状态
├── xiaohongshu_auto_publish.log # 运行日志
├── README.md                    # 项目说明
└── output/                      # 输出目录
    ├── notes/                   # 生成的笔记文案
    ├── images/                  # 生成的配图
    ├── qrcodes/                 # 登录二维码
    └── screenshots/             # 错误截图
```

## 🛠️ 安装依赖

```bash
pip install playwright requests python-dotenv
playwright install chromium
```

## ⚙️ 配置环境变量

创建 `.env` 文件并配置以下参数：

```env
# DeepSeek API配置
DEEPSEEK_API_KEY=your_deepseek_api_key_here

# 内容生成配置
NOTES_COUNT=5                    # 生成笔记数量
IMAGES_PER_NOTE=3               # 每篇笔记配图数量
CONTENT_THEME=人文摄影           # 内容主题
STYLE=专业                      # 文案风格
TARGET_AUDIENCE=20-30岁男性     # 目标受众

# 发布配置
PUBLISH_DELAY_MIN=10            # 发布间隔最小值（秒）
PUBLISH_DELAY_MAX=30            # 发布间隔最大值（秒）
```

## 🎯 使用方法

### 1. 基本使用

```bash
python xiaohongshu_auto.py
```

### 2. 运行流程

1. **初始化**: 程序启动后会检查配置和创建输出目录
2. **登录**: 自动打开浏览器并显示二维码，扫描登录
3. **内容生成**: 使用AI生成标题、文案和配图
4. **发布**: 按照正确流程自动发布到小红书
5. **循环**: 重复生成和发布指定数量的笔记

### 3. 发布流程优化

程序按照小红书的正确发布流程执行：

1. 点击"上传图文"按钮
2. 点击"上传图片"按钮并选择图片
3. 等待图片上传完成后添加标题
4. 在内容编辑器中输入正文
5. 添加相关话题标签
6. 点击发布按钮

## 🔧 技术特点

### 1. 智能登录管理
- 支持二维码扫码登录
- 自动保存和恢复登录状态
- 处理登录超时和二维码失效
- 多种登录状态检测方式

### 2. 内容优化
- 自动清理HTML标签
- 内容长度限制（2000字以内）
- 模拟真实用户输入行为
- 随机发布延迟避免检测

### 3. 错误处理
- 详细的日志记录
- 错误截图保存
- 异常恢复机制
- 多种选择器备选方案

### 4. 反检测机制
- 随机发布延迟
- 模拟真实用户操作
- 安全的控制台输出处理
- 浏览器指纹伪装

## 📊 运行状态监控

程序会生成详细的日志文件 `xiaohongshu_auto_publish.log`，包含：
- 登录状态
- 内容生成进度
- 发布结果
- 错误信息
- 调试截图

## ⚠️ 注意事项

1. **API密钥**: 请确保DeepSeek API密钥有效且有足够额度
2. **登录安全**: 首次使用需要扫码登录，后续会自动保存登录状态
3. **发布频率**: 建议设置合理的发布间隔，避免被平台检测
4. **内容质量**: 生成的内容仅供参考，建议人工审核后再发布
5. **平台政策**: 请遵守小红书平台的使用条款和内容规范

## 🐛 故障排除

### 常见问题

1. **找不到上传按钮**
   - 检查是否已正确登录
   - 查看错误截图了解页面状态
   - 可能需要更新选择器

2. **图片上传失败**
   - 检查图片文件是否存在
   - 确认图片格式支持
   - 查看网络连接状态

3. **登录失败**
   - 检查二维码是否清晰
   - 确认手机小红书APP已登录
   - 尝试刷新二维码

### 调试方法

1. 查看日志文件了解详细错误信息
2. 检查 `output/screenshots/` 目录中的错误截图
3. 设置 `HEADLESS=false` 查看浏览器操作过程

## 📈 扩展功能

### 可扩展的配置项
- 支持更多内容主题
- 自定义文案风格
- 灵活的发布策略
- 多账号管理

### 计划功能
- 内容模板系统
- 数据分析报告
- 定时发布功能
- 内容审核机制

## 📄 许可证

本项目仅供学习和研究使用，请遵守相关平台的使用条款。

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个项目。

---


**免责声明**: 本工具仅供学习和研究使用，使用者需要自行承担使用风险，并遵守相关平台的使用条款和法律法规。
